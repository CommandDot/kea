webpackJsonp([7],{554:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function a(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"default",function(){return f});var c=t(631),l=(t.n(c),t(6)),u=t.n(l),i=t(150),s=t(226),p=t(633),m=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),d={full:t(636),keyPath:t(637),reducers:t(638)},f=function(e){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return a(n,e),m(n,[{key:"render",value:function(){return u.a.createElement("div",{className:"counter-dynamic-scene"},u.a.createElement("div",{className:"description"},u.a.createElement("h2",null,"Example #2 - Dynamic Counter"),u.a.createElement("p",null,"This example demonstrates dynamically created actions and reducers."),u.a.createElement("p",null,"As we saw in the ",u.a.createElement(i.a,{to:"/guide/counter"},"previous example"),", if you render multiple instances of the same connected component, they will share the state."),u.a.createElement("p",null,"The guide below shows how to create multiple instances of one component with separate states:"),u.a.createElement("div",{className:"demo"},u.a.createElement(p.a,{id:1}),u.a.createElement("br",null),u.a.createElement(p.a,{id:2})),u.a.createElement("h2",null,"1. Key and path"),u.a.createElement("p",null,"The code for this example is almost the same as for the ",u.a.createElement(i.a,{to:"/guide/counter"},"previous counter"),"."),u.a.createElement("p",null,"The big difference is that we must manually tell our component instances where to store their data:"),u.a.createElement(s.default,{className:"javascript"},d.keyPath),u.a.createElement("p",null,"The ",u.a.createElement("code",null,"key")," function receives your component instance's ",u.a.createElement("code",null,"props")," as input and must return a key that's unique for the life of the component. Usually it's something like ",u.a.createElement("nobr",null,u.a.createElement("code",null,"key = (props) => props.id"))," if your component is rendered as ",u.a.createElement("nobr",null,u.a.createElement("code",null,"<Component id='somethingUnique' />"))),u.a.createElement("p",null,"The ",u.a.createElement("em",null,"optional")," ",u.a.createElement("code",null,"path")," function specifies where the data for your component will live in Redux. It takes just one argument, the ",u.a.createElement("code",null,"key")," from the previous step."),u.a.createElement("p",null,"Note! You may also use ",u.a.createElement("code",null,"path")," with non-dynamic components (like the ",u.a.createElement(i.a,{to:"/guide/counter"},"previous example"),") if you wish to specify where they will store their data."),u.a.createElement("p",null,"It makes your redux tree more readable and helps with debugging. In that case you have to skip the ",u.a.createElement("code",null,"key")," line."),u.a.createElement("h2",null,"2. Limiting the reducers"),u.a.createElement("p",null,"There's one last thing you need to do."),u.a.createElement("p",null,"While the reducers are unique for each component instance, the actions are shared."),u.a.createElement("p",null,"No matter which instance of your component triggers the action, all the reducers will receive it. So if counter #1 dispatches the ",u.a.createElement("code",null,"increment")," action, counter #2 will also receive it."),u.a.createElement("p",null,"In order to prevent this, you must check for the key in your reducers, like so:"),u.a.createElement(s.default,{className:"javascript"},d.reducers),u.a.createElement("p",null,"This way you can choose if your actions are processed by each instance of the component or by all instances simultaneously.")),u.a.createElement("div",{className:"description"},u.a.createElement("h2",null,"Final Example"),u.a.createElement("p",null,"While the following counters have separate data, they are still connected to the counters on top of this page, as they share the same ",u.a.createElement("code",null,"id"),"s. You can mix and match!"),u.a.createElement("div",{className:"demo"},u.a.createElement(p.a,{id:1}),u.a.createElement("br",null),u.a.createElement(p.a,{id:2})),u.a.createElement("p",null,"Next, check out the ",u.a.createElement(i.a,{to:"/guide/sliders"},"sliders")," demo to see how to add side effects to your code."),u.a.createElement("h2",null,"Full source"),u.a.createElement(s.default,{className:"javascript"},d.full),u.a.createElement("p",null,"Next page: ",u.a.createElement(i.a,{to:"/guide/sliders"},"Sliders"))))}}]),n}(l.Component)},631:function(e,n,t){var r=t(632);"string"==typeof r&&(r=[[e.i,r,""]]);var o={};o.transform=void 0;t(99)(r,o);r.locals&&(e.exports=r.locals)},632:function(e,n,t){n=e.exports=t(98)(void 0),n.push([e.i,".counter-dynamic-scene {\n  // text-align: center;\n}\n",""])},633:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function a(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}t.d(n,"a",function(){return h});var l,u,i=t(634),s=(t.n(i),t(6)),p=t.n(s),m=t(10),d=t.n(m),f=t(149),y=(t.n(f),function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}()),h=(l=Object(f.kea)({key:function(e){return e.id},path:function(e){return["scenes","counterDynamic","counter",e]},actions:function(){return{increment:function(){return{amount:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1}},decrement:function(){return{amount:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1}}}},reducers:function(e){var n,t=e.actions,r=e.key;e.props;return{counter:[0,d.a.number,(n={},c(n,t.increment,function(e,n){return n.key===r?e+n.amount:e}),c(n,t.decrement,function(e,n){return n.key===r?e-n.amount:e}),n)]}},selectors:function(e){var n=e.selectors;return{doubleCounter:[function(){return[n.counter]},function(e){return 2*e},d.a.number]}}}))(u=function(e){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return a(n,e),y(n,[{key:"render",value:function(){var e=this.props,n=e.counter,t=e.doubleCounter,r=this.actions,o=r.increment,a=r.decrement;return p.a.createElement("div",{className:"kea-counter"},"Count: ",n,p.a.createElement("br",null),"Doublecount: ",t,p.a.createElement("br",null),p.a.createElement("button",{onClick:function(){return o(1)}},"Increment"),p.a.createElement("button",{onClick:function(){return a(1)}},"Decrement"))}}]),n}(s.Component))||u},634:function(e,n,t){var r=t(635);"string"==typeof r&&(r=[[e.i,r,""]]);var o={};o.transform=void 0;t(99)(r,o);r.locals&&(e.exports=r.locals)},635:function(e,n,t){n=e.exports=t(98)(void 0),n.push([e.i,"",""])},636:function(e,n){e.exports="// counter/index.js\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { kea } from 'kea'\n\n@kea({\n  key: (props) => props.id,\n  path: (key) => ['scenes', 'counterDynamic', 'counter', key],\n\n  actions: () => ({\n    increment: (amount) => ({ amount }),\n    decrement: (amount) => ({ amount })\n  }),\n\n  reducers: ({ actions, key, props }) => ({\n    counter: [0, PropTypes.number, {\n      [actions.increment]: (state, payload) => payload.key === key ? state + payload.amount : state,\n      [actions.decrement]: (state, payload) => payload.key === key ? state - payload.amount : state\n    }]\n  }),\n\n  selectors: ({ selectors }) => ({\n    doubleCounter: [\n      () => [selectors.counter],\n      (counter) => counter * 2,\n      PropTypes.number\n    ]\n  })\n})\nexport default class Counter extends Component {\n  render () {\n    const { counter, doubleCounter } = this.props\n    const { increment, decrement } = this.actions\n\n    return (\n      <div className='kea-counter'>\n        Count: {counter}\n        <br />\n        Doublecount: {doubleCounter}\n        <br />\n        <button onClick={() => increment(1)}>Increment</button>\n        <button onClick={() => decrement(1)}>Decrement</button>\n      </div>\n    )\n  }\n}\n\n// index.js\nexport default class CounterDynamicScene extends Component {\n  render () {\n    return (\n      <div>\n        <Counter id={1} />\n        <Counter id={2} />\n      </div>\n    )\n  }\n}\n"},637:function(e,n){e.exports="import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { kea } from 'kea'\n\n@kea({\n  key: (props) => props.id,\n\n  path: (key) => ['scenes', 'counterDynamic', 'counter', key],\n\n  // ...\n})\nexport default class Counter extends Component {\n  // ...\n}\n"},638:function(e,n){e.exports="@kea({\n  key: (props) => props.id,\n  path: (key) => ['scenes', 'counterDynamic', 'counter', key],\n\n  actions: () => ({\n    increment: (amount = 1) => ({ amount }),\n    decrement: (amount = 1) => ({ amount })\n  }),\n\n  reducers: ({ actions, key, props }) => ({\n    counter: [0, PropTypes.number, {\n      [actions.increment]: (state, payload) => payload.key === key ? state + payload.amount : state,\n      [actions.decrement]: (state, payload) => payload.key === key ? state - payload.amount : state\n    }]\n  }),\n\n  // selectors: ...\n})\n"}});