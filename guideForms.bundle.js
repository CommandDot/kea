webpackJsonp([1],{560:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"default",function(){return x});var l,o,i=n(675),u=(n.n(i),n(6)),c=n.n(u),m=n(149),f=(n.n(m),n(150)),p=n(225),d=n(677),b=n(678),h=n(679),v=n(680),g=n(681),E=n(571),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),w={actionsReducers:n(684),component:n(685),takeLatest:n(686),errorsForm:n(687),errorsIndex:n(688),showErrorsRender:n(689),showErrorsSelector:n(690),simpleFull:n(691),createStub:n(692),createFormCall:n(693),createFormFunction:n(694),createFormIndex:n(695)},x=(l=Object(m.connect)({actions:[E.a,["toggleFeature"]],props:[E.a,["features"]]}))(o=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),y(t,[{key:"render",value:function(){var e=this.props.features,t=this.actions.toggleFeature;return c.a.createElement("div",{className:"counter-singleton-scene"},c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"Example #6 - Forms"),c.a.createElement("p",null,"Before Kea I used to dread forms in React. They would always require a lot of work to set up properly."),c.a.createElement("p",null,"I could either use ",c.a.createElement("code",null,"setState")," for the simplest one-component forms... or a ",c.a.createElement("a",{href:"https://github.com/erikras/redux-form/issues/2315"},"bulky library")," like ",c.a.createElement("a",{href:"https://redux-form.com/"},"redux-form")," for a connected Redux-based form. Neither of those is a great option... and writing a pure-redux-form requires way too much boilerplate."),c.a.createElement("p",null,"With Kea, forms are finally easy! Even the code to setup a form from scratch is quick to write, as you shall soon see.")),c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"What shall we do?"),c.a.createElement("p",null,"In this chapter we will first build a simple form that looks like this:"),c.a.createElement("div",{className:"demo"},c.a.createElement(v.a,null)),c.a.createElement("p",null,c.a.createElement("em",null,"Go ahead, play with it!")),c.a.createElement("p",null,"... and then abstract the remaining boilerplate into a form builder.")),c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"Defining the features we need"),c.a.createElement("p",null,"If you played with the demo above, you'll see what we need to build the following features:"),c.a.createElement("ul",null,c.a.createElement("li",null,"Default values"),c.a.createElement("li",null,"Custom validation rules"),c.a.createElement("li",null,'Show errors only after we have pressed "submit"'),c.a.createElement("li",null,"Disable the submit button when submitting"),c.a.createElement("li",null,"Async processing of the request")),c.a.createElement("p",null,"Let's build it piece by piece, starting with the data model.")),c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"Actions and reducers"),c.a.createElement("p",null,"So what do we need to keep track of in order to build this form?"),c.a.createElement("p",null,"At the very minimum, we'll need the following reducers:"),c.a.createElement("ul",null,c.a.createElement("li",null,"An object ",c.a.createElement("code",null,"values"),", which contains the form data (",c.a.createElement("code",null,"name"),", ",c.a.createElement("code",null,"email")," and ",c.a.createElement("code",null,"message"),")"),c.a.createElement("li",null,"A boolean ",c.a.createElement("code",null,"isSubmitting"),", which knows if we're actively submitting the form or not"),c.a.createElement("li",null,"A boolean ",c.a.createElement("code",null,"showErrors")," to know if we will show errors or not")),c.a.createElement("p",null,"These three reducers are enough to give us everything, except for validation rules and errors. We'll skip those for now."),c.a.createElement("p",null,"What about the actions we can perform on the form? The minimum set is as follows:"),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"setValue")," to update the value of one field (or ",c.a.createElement("code",null,"setValues")," to update many simultaneously)"),c.a.createElement("li",null,c.a.createElement("code",null,"submit"),", to try to submit the form"),c.a.createElement("li",null,c.a.createElement("code",null,"submitSuccess"),", if the form was successfully submitted"),c.a.createElement("li",null,c.a.createElement("code",null,"submitFailure"),", if there was an error, e.g. a validation mismatch")),c.a.createElement("p",null,"Putting them together and adding ",c.a.createElement("code",null,"defaults")," and ",c.a.createElement("code",null,"propTypes")," gives us the following code:"),c.a.createElement(p.default,{className:"javascript"},w.actionsReducers),c.a.createElement("p",null,"Seems clear enough? :)")),c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"The component"),c.a.createElement("p",null,"We could continue extending the logic by adding error handling, validations and actual submission logic, but since it's nice to see something tangible, let's first build the component itself!"),c.a.createElement("p",null,"A very crude version will look something like this:"),c.a.createElement(p.default,{className:"javascript"},w.component),c.a.createElement("p",null,"This code works! In fact, try it below:"),c.a.createElement("div",{className:"demo"},c.a.createElement(d.a,null)),c.a.createElement("p",null,'The only problem: once you hit "submit", it will forever be stuck in the ',c.a.createElement("code",null,"isSubmitting")," state."),c.a.createElement("p",null,"We need to add some logic to make it actually do something.")),c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"Submitting the form"),c.a.createElement("p",null,"We will use the ",c.a.createElement("code",null,"takeLatest")," helper to listen to the submit action and respond with either a ",c.a.createElement("code",null,"submitSuccess")," or ",c.a.createElement("code",null,"submitFailure")," action:"),c.a.createElement(p.default,{className:"javascript"},w.takeLatest),c.a.createElement("p",null,"Adding this code results in the following form:"),c.a.createElement("div",{className:"demo"},c.a.createElement(b.a,null)),c.a.createElement("p",null,"Go ahead, write some data and try submitting it!"),c.a.createElement("p",null,"If you replace the ",c.a.createElement("code",null,"yield delay(1000)")," part with an actual API call, this will be a fully functional form."),c.a.createElement("p",null,"Only one thing left to do...")),c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"Errors and validation"),c.a.createElement("p",null,"We want to prevent an empty form from being submitted!"),c.a.createElement("p",null,"The easiest solution is to create a selector ",c.a.createElement("code",null,"errors")," that depends on ",c.a.createElement("code",null,"values"),". This selector checks the content of each field and returns an object describing which fields have errors."),c.a.createElement("p",null,"We'll also create another selector ",c.a.createElement("code",null,"hasErrors"),', which gives a simple yes/no answer to the question "does this form have errors?".'),c.a.createElement("p",null,"Finally, we'll check the value of ",c.a.createElement("code",null,"hasErrors")," in the ",c.a.createElement("code",null,"submit")," worker, and dispatch a ",c.a.createElement("code",null,"submitFailure")," action in case the form doesn't pass the validation."),c.a.createElement("p",null,"Something like this:"),c.a.createElement(p.default,{className:"javascript"},w.errorsForm),c.a.createElement("p",null,"In order to display the errors, we will also update our component as follows:"),c.a.createElement(p.default,{className:"javascript"},w.errorsIndex),c.a.createElement("p",null,"Plugging in the changes results in the following form:"),c.a.createElement("div",{className:"demo"},c.a.createElement(h.a,null)),c.a.createElement("p",null,"Almost perfect! The only thing: we don't want to show the ",c.a.createElement("span",{style:{color:"red"}},"red")," errors ",c.a.createElement("em",null,"before")," the user submits the form."),c.a.createElement("p",null,"Remember the ",c.a.createElement("code",null,"showErrors")," reducer from before? Now is its time to shine!"),c.a.createElement("p",null,"We have two choices with it. We can either use it in our ",c.a.createElement("code",null,"render")," function like so:"),c.a.createElement(p.default,{className:"javascript"},w.showErrorsRender),c.a.createElement("p",null,"... or we can simply return an empty hash for the ",c.a.createElement("code",null,"errors")," selector until ",c.a.createElement("code",null,"showErrors")," becomes true."),c.a.createElement("p",null,"I prefer the second approach as it moves the form logic away from the ",c.a.createElement("code",null,"render")," function."),c.a.createElement("p",null,"In order to do this, we'll rename the previous selector ",c.a.createElement("code",null,"errors")," into ",c.a.createElement("code",null,"allErrors")," and make an new selector ",c.a.createElement("code",null,"errors"),", that depends on both ",c.a.createElement("code",null,"allErrors")," and ",c.a.createElement("code",null,"showErrors"),". We'll also make ",c.a.createElement("code",null,"hasErrors")," depend on the renamed ",c.a.createElement("code",null,"allErrors"),":"),c.a.createElement(p.default,{className:"javascript"},w.showErrorsSelector),c.a.createElement("p",null,"And that's it! With a few actons, reducers and selectors, totalling about 75 lines of code, you have a fully functional and extremely extendable form library at your disposal!"),c.a.createElement("p",null,"This is the final result:"),c.a.createElement("p",null,c.a.createElement("em",null,"Note that it shares data with the form on top of the page.")),c.a.createElement("div",{className:"demo"},c.a.createElement(v.a,null)),c.a.createElement("p",null,c.a.createElement("button",{onClick:function(){return t("finalCode")}},"Show the full source")),e.finalCode?c.a.createElement(p.default,{className:"javascript"},w.simpleFull):null),c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"Abstracting ",c.a.createElement("code",null,"createForm")),c.a.createElement("p",null,"As you saw, it's really easy to create forms with Kea. And you're no longer dependant on heavy (~50KB) form libraries!"),c.a.createElement("p",null,"That said, what if you need a second form on your page? Should you copy paste all this code around?"),c.a.createElement("p",null,"No!"),c.a.createElement("p",null,"There's not a lot of boilerplate with our form solution, but even what is there can be eliminated."),c.a.createElement("p",null,"Let's build a form builder!"),c.a.createElement("p",null,"The principle here is simple. We'll create a function, ",c.a.createElement("code",null,"createForm"),", that takes as an input all the form-specific data and returns a ",c.a.createElement("code",null,"kea({})")," logic store. Something like this:"),c.a.createElement(p.default,{className:"javascript"},w.createStub),c.a.createElement("p",null,"So what is all of the form-specific data? What kind of an API do we want the ",c.a.createElement("code",null,"createForm")," function to have?"),c.a.createElement("p",null,"Well, here's one option:"),c.a.createElement(p.default,{className:"javascript"},w.createFormCall),c.a.createElement("p",null,"That's about as lean as it gets!"),c.a.createElement("p",null,"And what about this ",c.a.createElement("code",null,"createForm"),"?"),c.a.createElement("p",null,"Turns out it requires very minimal changes from the code above. Here it is in all its glory. See if you can spot what changed:"),c.a.createElement(p.default,{className:"javascript"},w.createFormFunction),c.a.createElement("p",null,"Since the result of calling ",c.a.createElement("code",null,"createForm")," is just a regular kea logic store, you may connect to it in any way you please. In fact, the code for the component itself is identical to what you saw above."),c.a.createElement("p",null,"Here it is again for completion:"),c.a.createElement(p.default,{className:"javascript"},w.createFormIndex),c.a.createElement("p",null,"And this is the created form in action:"),c.a.createElement("div",{className:"demo"},c.a.createElement(g.a,null)),c.a.createElement("p",null,"Now, there are surely additional things that can be done. For example:"),c.a.createElement("ol",null,c.a.createElement("li",null,"You may create an abstract ",c.a.createElement("code",null,"Field")," component that removes even more boilerplate."),c.a.createElement("li",null,"You may add extra code for async validation. E.g. checking if the username is taken or not."),c.a.createElement("li",null,"You may publish this ",c.a.createElement("code",null,"createForm")," as a separate NPM package and reap all the fame that comes with being an open source maintainer :).")),c.a.createElement("p",null,"... but those things are outside the scope of this guide and are left as an exercise for the reader."),c.a.createElement("p",null,"I hope you found this guide useful!"),c.a.createElement("p",null,"Happy hacking! :D"),c.a.createElement("h2",null,"Next steps"),c.a.createElement("p",null,"The last topic in this guide: ",c.a.createElement(f.a,{to:"/guide/migration"},"How to migrate existing Redux applications?")," or read the ",c.a.createElement(f.a,{to:"/api/logic"},"API docs"),".")))}}]),t}(u.Component))||o},571:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r=n(10),s=n.n(r),l=n(149),o=(n.n(l),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e});t.a=Object(l.kea)({actions:function(){return{toggleFeature:function(e){return{feature:e}}}},reducers:function(e){var t=e.actions;return{features:[{},s.a.object,a({},t.toggleFeature,function(e,t){var n=t.feature;return o({},e,a({},n,!e[n]))})]}}})},675:function(e,t,n){var a=n(676);"string"==typeof a&&(a=[[e.i,a,""]]);var r={};r.transform=void 0;n(99)(a,r);a.locals&&(e.exports=a.locals)},676:function(e,t,n){t=e.exports=n(98)(void 0),t.push([e.i,".form-field {\n  margin-bottom: 10px;\n}\n\n  .form-field label {\n    display: block;\n    font-size: 14px;\n  }\n\n  .form-field .form-error {\n    color: red;\n    font-size: 12px;\n  }\n\n  .form-field input[type=text], .form-field textarea {\n    font-size: 13px;\n    line-height: 20px;\n    min-width: 280px;\n    border: 1px solid #ccc;\n    margin-bottom: 0;\n  }\n",""])},677:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return v});var o,i,u=n(6),c=n.n(u),m=n(10),f=n.n(m),p=n(149),d=(n.n(p),function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}()),b={name:"John Doe",email:"",message:""},h={name:f.a.string,email:f.a.string,message:f.a.string},v=(o=Object(p.kea)({actions:function(){return{setValue:function(e,t){return{key:e,value:t}},setValues:function(e){return{values:e}},submit:!0,submitSuccess:!0,submitFailure:!0}},reducers:function(e){var t,n,a,r=e.actions;return{values:[b,f.a.shape(h),(t={},l(t,r.setValue,function(e,t){return Object.assign({},e,l({},t.key,t.value))}),l(t,r.setValues,function(e,t){return Object.assign({},e,t.values)}),l(t,r.submitSuccess,function(){return b}),t)],isSubmitting:[!1,f.a.bool,(n={},l(n,r.submit,function(){return!0}),l(n,r.submitSuccess,function(){return!1}),l(n,r.submitFailure,function(){return!1}),n)],showErrors:[!1,f.a.bool,(a={},l(a,r.submit,function(){return!0}),l(a,r.submitSuccess,function(){return!1}),a)]}}}))(i=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),d(t,[{key:"render",value:function(){var e=this.props,t=e.isSubmitting,n=e.values,a=this.actions,r=a.submit,s=a.setValue,l=n.name,o=n.email,i=n.message;return c.a.createElement("div",null,c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"Name"),c.a.createElement("input",{type:"text",value:l,onChange:function(e){return s("name",e.target.value)}})),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"E-mail"),c.a.createElement("input",{type:"text",value:o,onChange:function(e){return s("email",e.target.value)}})),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",{className:"block"},"Message"),c.a.createElement("textarea",{value:i,onChange:function(e){return s("message",e.target.value)}})),c.a.createElement("button",{disabled:t,onClick:r},t?"Submitting...":"Submit!"))}}]),t}(u.Component))||i},678:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return E});var o,i,u=n(6),c=n.n(u),m=n(10),f=n.n(m),p=n(149),d=(n.n(p),n(53)),b=n(151),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),v={name:"John Doe",email:"",message:""},g={name:f.a.string,email:f.a.string,message:f.a.string},E=(o=Object(p.kea)({actions:function(){return{setValue:function(e,t){return{key:e,value:t}},setValues:function(e){return{values:e}},submit:!0,submitSuccess:!0,submitFailure:!0}},reducers:function(e){var t,n,a,r=e.actions;return{values:[v,f.a.shape(g),(t={},l(t,r.setValue,function(e,t){return Object.assign({},e,l({},t.key,t.value))}),l(t,r.setValues,function(e,t){return Object.assign({},e,t.values)}),l(t,r.submitSuccess,function(){return v}),t)],isSubmitting:[!1,f.a.bool,(n={},l(n,r.submit,function(){return!0}),l(n,r.submitSuccess,function(){return!1}),l(n,r.submitFailure,function(){return!1}),n)],showErrors:[!1,f.a.bool,(a={},l(a,r.submit,function(){return!0}),l(a,r.submitSuccess,function(){return!1}),a)]}},takeLatest:function(e){var t=e.actions;e.workers;return l({},t.submit,regeneratorRuntime.mark(function e(){var t,n,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.actions,n=t.submitSuccess,a=t.submitFailure,e.next=3,this.get("values");case 3:return r=e.sent,console.log("Submitting form with values:",r),e.next=7,Object(b.delay)(1e3);case 7:return window.alert("Success"),e.next=11,Object(d.put)(n());case 11:e.next=16;break;case 13:return window.alert("Error"),e.next=16,Object(d.put)(a());case 16:case"end":return e.stop()}},e,this)}))}}))(i=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),h(t,[{key:"render",value:function(){var e=this.props,t=e.isSubmitting,n=e.values,a=this.actions,r=a.submit,s=a.setValue,l=n.name,o=n.email,i=n.message;return c.a.createElement("div",null,c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"Name"),c.a.createElement("input",{type:"text",value:l,onChange:function(e){return s("name",e.target.value)}})),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"E-mail"),c.a.createElement("input",{type:"text",value:o,onChange:function(e){return s("email",e.target.value)}})),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",{className:"block"},"Message"),c.a.createElement("textarea",{value:i,onChange:function(e){return s("message",e.target.value)}})),c.a.createElement("button",{disabled:t,onClick:r},t?"Submitting...":"Submit!"))}}]),t}(u.Component))||i},679:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return w});var o,i,u=n(6),c=n.n(u),m=n(10),f=n.n(m),p=n(149),d=(n.n(p),n(53)),b=n(151),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),v=function(e){return/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)},g="This field is required",E={name:"John Doe",email:"",message:""},y={name:f.a.string,email:f.a.string,message:f.a.string},w=(o=Object(p.kea)({actions:function(){return{setValue:function(e,t){return{key:e,value:t}},setValues:function(e){return{values:e}},submit:!0,submitSuccess:!0,submitFailure:!0}},reducers:function(e){var t,n,a,r=e.actions;return{values:[E,f.a.shape(y),(t={},l(t,r.setValue,function(e,t){return Object.assign({},e,l({},t.key,t.value))}),l(t,r.setValues,function(e,t){return Object.assign({},e,t.values)}),l(t,r.submitSuccess,function(){return E}),t)],isSubmitting:[!1,f.a.bool,(n={},l(n,r.submit,function(){return!0}),l(n,r.submitSuccess,function(){return!1}),l(n,r.submitFailure,function(){return!1}),n)],showErrors:[!1,f.a.bool,(a={},l(a,r.submit,function(){return!0}),l(a,r.submitSuccess,function(){return!1}),a)]}},selectors:function(e){var t=e.selectors;return{errors:[function(){return[t.values]},function(e){return{name:e.name?null:g,email:e.email?v(e.email)?null:"Invalid e-mail":g,message:e.message?null:g}},f.a.object],hasErrors:[function(){return[t.errors]},function(e){return Object.values(e).filter(function(e){return e}).length>0},f.a.bool]}},takeLatest:function(e){var t=e.actions;e.workers;return l({},t.submit,regeneratorRuntime.mark(function e(){var t,n,a,r,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.actions,n=t.submitSuccess,a=t.submitFailure,e.next=3,this.get("hasErrors");case 3:if(!(r=e.sent)){e.next=8;break}return e.next=7,Object(d.put)(a());case 7:return e.abrupt("return");case 8:return e.next=10,this.get("values");case 10:return s=e.sent,console.log("Submitting form with values:",s),e.next=14,Object(b.delay)(1e3);case 14:return window.alert("Success"),e.next=18,Object(d.put)(n());case 18:e.next=23;break;case 20:return window.alert("Error"),e.next=23,Object(d.put)(a());case 23:case"end":return e.stop()}},e,this)}))}}))(i=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),h(t,[{key:"render",value:function(){var e=this.props,t=e.isSubmitting,n=e.errors,a=e.values,r=this.actions,s=r.submit,l=r.setValue,o=a.name,i=a.email,u=a.message;return c.a.createElement("div",null,c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"Name"),c.a.createElement("input",{type:"text",value:o,onChange:function(e){return l("name",e.target.value)}}),n.name?c.a.createElement("div",{className:"form-error"},n.name):null),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"E-mail"),c.a.createElement("input",{type:"text",value:i,onChange:function(e){return l("email",e.target.value)}}),n.email?c.a.createElement("div",{className:"form-error"},n.email):null),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",{className:"block"},"Message"),c.a.createElement("textarea",{value:u,onChange:function(e){return l("message",e.target.value)}}),n.message?c.a.createElement("div",{className:"form-error"},n.message):null),c.a.createElement("button",{disabled:t,onClick:s},t?"Submitting...":"Submit!"))}}]),t}(u.Component))||i},680:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return w});var o,i,u=n(6),c=n.n(u),m=n(10),f=n.n(m),p=n(149),d=(n.n(p),n(53)),b=n(151),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),v=function(e){return/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)},g={name:"John Doe",email:"",message:""},E={name:f.a.string,email:f.a.string,message:f.a.string},y="This field is required",w=(o=Object(p.kea)({actions:function(){return{setValue:function(e,t){return{key:e,value:t}},setValues:function(e){return{values:e}},submit:!0,submitSuccess:!0,submitFailure:!0}},reducers:function(e){var t,n,a,r=e.actions;return{values:[g,f.a.shape(E),(t={},l(t,r.setValue,function(e,t){return Object.assign({},e,l({},t.key,t.value))}),l(t,r.setValues,function(e,t){return Object.assign({},e,t.values)}),l(t,r.submitSuccess,function(){return g}),t)],isSubmitting:[!1,f.a.bool,(n={},l(n,r.submit,function(){return!0}),l(n,r.submitSuccess,function(){return!1}),l(n,r.submitFailure,function(){return!1}),n)],showErrors:[!1,f.a.bool,(a={},l(a,r.submit,function(){return!0}),l(a,r.submitSuccess,function(){return!1}),a)]}},selectors:function(e){var t=e.selectors;return{allErrors:[function(){return[t.values]},function(e){return{name:e.name?null:y,email:e.email?v(e.email)?null:"Invalid e-mail":y,message:e.message?null:y}},f.a.object],hasErrors:[function(){return[t.allErrors]},function(e){return Object.values(e).filter(function(e){return e}).length>0},f.a.bool],errors:[function(){return[t.allErrors,t.showErrors]},function(e,t){return t?e:{}},f.a.object]}},takeLatest:function(e){var t=e.actions;e.workers;return l({},t.submit,regeneratorRuntime.mark(function e(){var t,n,a,r,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.actions,n=t.submitSuccess,a=t.submitFailure,e.next=3,this.get("hasErrors");case 3:if(!(r=e.sent)){e.next=8;break}return e.next=7,Object(d.put)(a());case 7:return e.abrupt("return");case 8:return e.next=10,this.get("values");case 10:return s=e.sent,console.log("Submitting form with values:",s),e.next=14,Object(b.delay)(1e3);case 14:if(!s){e.next=20;break}return window.alert("Success"),e.next=18,Object(d.put)(n());case 18:e.next=23;break;case 20:return window.alert("Error"),e.next=23,Object(d.put)(a());case 23:case"end":return e.stop()}},e,this)}))}}))(i=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),h(t,[{key:"render",value:function(){var e=this.props,t=e.isSubmitting,n=e.errors,a=e.values,r=this.actions,s=r.submit,l=r.setValue,o=a.name,i=a.email,u=a.message;return c.a.createElement("div",null,c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"Name"),c.a.createElement("input",{type:"text",value:o,onChange:function(e){return l("name",e.target.value)}}),n.name?c.a.createElement("div",{className:"form-error"},n.name):null),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",null,"E-mail"),c.a.createElement("input",{type:"text",value:i,onChange:function(e){return l("email",e.target.value)}}),n.email?c.a.createElement("div",{className:"form-error"},n.email):null),c.a.createElement("div",{className:"form-field"},c.a.createElement("label",{className:"block"},"Message"),c.a.createElement("textarea",{value:u,onChange:function(e){return l("message",e.target.value)}}),n.message?c.a.createElement("div",{className:"form-error"},n.message):null),c.a.createElement("button",{disabled:t,onClick:s},t?"Submitting...":"Submit!"))}}]),t}(u.Component))||i},681:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return p});var l,o,i=n(6),u=n.n(i),c=n(149),m=(n.n(c),n(682)),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),p=(l=Object(c.connect)({actions:[m.a,["setValue","submit"]],props:[m.a,["values","isSubmitting","errors"]]}))(o=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),f(t,[{key:"render",value:function(){var e=this.props,t=e.isSubmitting,n=e.errors,a=e.values,r=this.actions,s=r.submit,l=r.setValue,o=a.name,i=a.email,c=a.message;return u.a.createElement("div",null,u.a.createElement("div",{className:"form-field"},u.a.createElement("label",null,"Name"),u.a.createElement("input",{type:"text",value:o,onChange:function(e){return l("name",e.target.value)}}),n.name?u.a.createElement("div",{className:"form-error"},n.name):null),u.a.createElement("div",{className:"form-field"},u.a.createElement("label",null,"E-mail"),u.a.createElement("input",{type:"text",value:i,onChange:function(e){return l("email",e.target.value)}}),n.email?u.a.createElement("div",{className:"form-error"},n.email):null),u.a.createElement("div",{className:"form-field"},u.a.createElement("label",{className:"block"},"Message"),u.a.createElement("textarea",{value:c,onChange:function(e){return l("message",e.target.value)}}),n.message?u.a.createElement("div",{className:"form-error"},n.message):null),u.a.createElement("button",{disabled:t,onClick:s},t?"Submitting...":"Submit!"))}}]),t}(i.Component))||o},682:function(e,t,n){"use strict";var a=n(10),r=n.n(a),s=n(151),l=n(683),o=function(e){return/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)},i="This field is required";t.a=Object(l.a)({propTypes:{name:r.a.string,email:r.a.string,message:r.a.string},defaults:{name:"John Doe",email:"",message:""},validate:function(e){return{name:e.name?null:i,email:e.email?o(e.email)?null:"Invalid e-mail":i,message:e.message?null:i}},submit:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.delay)(1e3);case 2:case"end":return e.stop()}},e,this)}),success:regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.alert("submit successful!",t);case 1:case"end":return e.stop()}},e,this)}),failure:regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.alert("submit error!",t);case 1:case"end":return e.stop()}},e,this)})})},683:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){var t=e.propTypes?l.a.shape(e.propTypes):l.a.object,n=e.defaults||{},r=e.validate||u,s=e.submit||u,c=e.success||u,m=e.failure||u;return Object(o.kea)({actions:function(){return{setValue:function(e,t){return{key:e,value:t}},setValues:function(e){return{values:e}},submit:!0,submitSuccess:function(e){return{response:e}},submitFailure:function(e){return{error:e}}}},reducers:function(e){var r,s,o,i=e.actions;return{values:[n,t,(r={},a(r,i.setValue,function(e,t){return Object.assign({},e,a({},t.key,t.value))}),a(r,i.setValues,function(e,t){return Object.assign({},e,t.values)}),a(r,i.submitSuccess,function(){return n}),r)],isSubmitting:[!1,l.a.bool,(s={},a(s,i.submit,function(){return!0}),a(s,i.submitSuccess,function(){return!1}),a(s,i.submitFailure,function(){return!1}),s)],showErrors:[!1,l.a.bool,(o={},a(o,i.submit,function(){return!0}),a(o,i.submitSuccess,function(){return!1}),o)]}},selectors:function(e){var t=e.selectors;return{allErrors:[function(){return[t.values]},r,l.a.object],hasErrors:[function(){return[t.allErrors]},function(e){return Object.values(e).filter(function(e){return e}).length>0},l.a.bool],errors:[function(){return[t.allErrors,t.showErrors]},function(e,t){return t?e:{}},l.a.object]}},takeLatest:function(e){var t=e.actions;e.workers;return a({},t.submit,regeneratorRuntime.mark(function e(){var t,n,a,r,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.actions,n=t.submitSuccess,a=t.submitFailure,e.next=3,this.get("hasErrors");case 3:if(!(r=e.sent)){e.next=8;break}return e.next=7,Object(i.put)(a());case 7:return e.abrupt("return");case 8:return e.prev=8,e.next=11,Object(i.call)(s.bind(this));case 11:return l=e.sent,e.next=14,Object(i.call)(c.bind(this),l);case 14:return e.next=16,Object(i.put)(n(l));case 16:e.next=24;break;case 18:return e.prev=18,e.t0=e.catch(8),e.next=22,Object(i.call)(m.bind(this),e.t0);case 22:return e.next=24,Object(i.put)(a(e.t0));case 24:case"end":return e.stop()}},e,this,[[8,18]])}))}})}n.d(t,"a",function(){return r});var s=n(10),l=n.n(s),o=n(149),i=(n.n(o),n(53)),u=function(){return{}}},684:function(e,t){e.exports="// form.js\n\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { kea } from 'kea'\n\nconst defaults = {\n  name: 'John Doe',\n  email: '',\n  message: ''\n}\n\nconst propTypes = {\n  name: PropTypes.string,\n  email: PropTypes.string,\n  message: PropTypes.string\n}\n\nexport default kea({\n  actions: () => ({\n    setValue: (key, value) => ({ key, value }),\n    setValues: (values) => ({ values }),\n\n    submit: true,\n    submitSuccess: true,\n    submitFailure: true\n  }),\n\n  reducers: ({ actions }) => ({\n    values: [defaults, PropTypes.shape(propTypes), {\n      [actions.setValue]: (state, payload) => {\n        return Object.assign({}, state, { [payload.key]: payload.value })\n      },\n      [actions.setValues]: (state, payload) => {\n        return Object.assign({}, state, payload.values)\n      },\n      [actions.submitSuccess]: () => defaults\n    }],\n\n    isSubmitting: [false, PropTypes.bool, {\n      [actions.submit]: () => true,\n      [actions.submitSuccess]: () => false,\n      [actions.submitFailure]: () => false\n    }],\n\n    showErrors: [false, PropTypes.bool, {\n      [actions.submit]: () => true,\n      [actions.submitSuccess]: () => false\n    }]\n  }),\n\n  // ...\n})\n\n"},685:function(e,t){e.exports="// index.js\n\nimport React, { Component } from 'react'\nimport { connect } from 'kea'\n\nimport form from './form'\n\n@connect({\n  actions: [\n    form, [\n      'setValue',\n      'submit'\n    ]\n  ],\n  props: [\n    form, [\n      'values',\n      'isSubmitting'\n    ]\n  ]\n})\nexport default class FormComponent extends Component {\n  render () {\n    const { isSubmitting, values } = this.props\n    const { submit, setValue } = this.actions\n\n    const { name, email, message } = values\n\n    return (\n      <div>\n        <div className='form-field'>\n          <label>Name</label>\n          <input type='text' value={name} onChange={e => setValue('name', e.target.value)} />\n        </div>\n\n        <div className='form-field'>\n          <label>E-mail</label>\n          <input type='text' value={email} onChange={e => setValue('email', e.target.value)} />\n        </div>\n\n        <div className='form-field'>\n          <label className='block'>Message</label>\n          <textarea value={message} onChange={e => setValue('message', e.target.value)} />\n        </div>\n\n        <button disabled={isSubmitting} onClick={submit}>\n          {isSubmitting ? 'Submitting...' : 'Submit!'}\n        </button>\n      </div>\n    )\n  }\n}\n"},686:function(e,t){e.exports="// form.js\n\nimport { put } from 'redux-saga/effects'\nimport { delay } from 'redux-saga'\n\nexport default kea({\n  // actions, reducers, ...\n\n  takeLatest: ({ actions, workers }) => ({\n    [actions.submit]: function * () {\n      const { submitSuccess, submitFailure } = this.actions\n\n      // get the form data...\n      const values = yield this.get('values')\n      console.log('Submitting form with values:', values)\n\n      // simulate a 1sec async request.\n      yield delay(1000)\n\n      if (true) { // if the request was successful\n        window.alert('Success')\n        yield put(submitSuccess())\n      } else {\n        window.alert('Error')\n        yield put(submitFailure())\n      }\n    }\n  })\n})\n\n"},687:function(e,t){e.exports="// form.js\n\n// ...\n\nconst isEmailValid = (email) => /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(email)\n\nconst missingText = 'This field is required'\nconst invalidEmail = 'Invalid e-mail'\n\nexport default kea({\n  // actions, reducers, takeLatest, ...\n\n  selectors: ({ selectors }) => ({\n    errors: [\n      () => [selectors.values],\n      (values) => ({\n        name: !values.name ? missingText : null,\n        email: !values.email ? missingText : (!isEmailValid(values.email) ? invalidEmail : null),\n        message: !values.message ? missingText : null\n      }),\n      PropTypes.object\n    ],\n\n    hasErrors: [\n      () => [selectors.errors],\n      (errors) => Object.values(errors).filter(k => k).length > 0,\n      PropTypes.bool\n    ]\n  }),\n\n  takeLatest: ({ actions, workers }) => ({\n    [actions.submit]: function * () {\n      const { submitSuccess, submitFailure } = this.actions\n\n      const hasErrors = yield this.get('hasErrors')\n\n      if (hasErrors) {\n        yield put(submitFailure())\n        return\n      }\n\n      // ... the rest of the submit worker\n    }\n  })\n})\n"},688:function(e,t){e.exports="// index.js\n\nexport default class Form extends Component {\n  render () {\n    const { isSubmitting, errors, values } = this.props\n    const { submit, setValue } = this.actions\n\n    const { name, email, message } = values\n\n    return (\n      <div>\n        <div className='form-field'>\n          <label>Name</label>\n          <input type='text' value={name} onChange={e => setValue('name', e.target.value)} />\n          {errors.name ? <div className='form-error'>{errors.name}</div> : null}\n        </div>\n\n        <div className='form-field'>\n          <label>E-mail</label>\n          <input type='text' value={email} onChange={e => setValue('email', e.target.value)} />\n          {errors.email ? <div className='form-error'>{errors.email}</div> : null}\n        </div>\n\n        <div className='form-field'>\n          <label className='block'>Message</label>\n          <textarea value={message} onChange={e => setValue('message', e.target.value)} />\n          {errors.message ? <div className='form-error'>{errors.message}</div> : null}\n        </div>\n\n        <button disabled={isSubmitting} onClick={submit}>\n          {isSubmitting ? 'Submitting...' : 'Submit!'}\n        </button>\n      </div>\n    )\n  }\n}\n"},689:function(e,t){e.exports="export default class Form extends Component {\n  render () {\n    const { isSubmitting, errors, values, showErrors } = this.props\n\n    return (\n      <div>\n        <div className='form-field'>\n          ...\n          {showErrors && errors.name\n            ? <div className='form-error'>{errors.name}</div>\n            : null}\n        </div>\n        ...\n      </div>\n    )\n  }\n}\n"},690:function(e,t){e.exports="// form.js\n\n// ...\n\nexport default kea({\n  // actions, reducers, takeLatest, ...\n\n  selectors: ({ selectors }) => ({\n    allErrors: [\n      () => [selectors.values],\n      (values) => ({\n        name: !values.name ? missingText : null,\n        email: !values.email ? missingText : (!isEmailValid(values.email) ? invalidEmail : null),\n        message: !values.message ? missingText : null\n      }),\n      PropTypes.object\n    ],\n\n    hasErrors: [\n      () => [selectors.allErrors],\n      (allErrors) => Object.values(allErrors).filter(k => k).length > 0,\n      PropTypes.bool\n    ],\n\n    errors: [\n      () => [selectors.allErrors, selectors.showErrors],\n      (errors, showErrors) => showErrors ? errors : {},\n      PropTypes.object\n    ]\n  })\n})\n"},691:function(e,t){e.exports="import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { kea } from 'kea'\nimport { put } from 'redux-saga/effects'\nimport { delay } from 'redux-saga'\n\nconst isEmailValid = (email) => /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(email)\n\nconst defaultValues = {\n  name: 'John Doe',\n  email: '',\n  message: ''\n}\n\nconst propTypes = {\n  name: PropTypes.string,\n  email: PropTypes.string,\n  message: PropTypes.string\n}\n\nconst missingText = 'This field is required'\n\n@kea({\n  actions: () => ({\n    setValue: (key, value) => ({ key, value }),\n    setValues: (values) => ({ values }),\n\n    submit: true,\n    submitSuccess: true,\n    submitFailure: true\n  }),\n\n  reducers: ({ actions }) => ({\n    values: [defaultValues, PropTypes.shape(propTypes), {\n      [actions.setValue]: (state, payload) => Object.assign({}, state, { [payload.key]: payload.value }),\n      [actions.setValues]: (state, payload) => Object.assign({}, state, payload.values),\n      [actions.submitSuccess]: () => defaultValues\n    }],\n\n    isSubmitting: [false, PropTypes.bool, {\n      [actions.submit]: () => true,\n      [actions.submitSuccess]: () => false,\n      [actions.submitFailure]: () => false\n    }],\n\n    showErrors: [false, PropTypes.bool, {\n      [actions.submit]: () => true,\n      [actions.submitSuccess]: () => false\n    }]\n  }),\n\n  selectors: ({ selectors }) => ({\n    allErrors: [\n      () => [selectors.values],\n      (values) => ({\n        name: !values.name ? missingText : null,\n        email: !values.email ? missingText : (!isEmailValid(values.email) ? 'Invalid e-mail' : null),\n        message: !values.message ? missingText : null\n      }),\n      PropTypes.object\n    ],\n\n    hasErrors: [\n      () => [selectors.allErrors],\n      (allErrors) => Object.values(allErrors).filter(k => k).length > 0,\n      PropTypes.bool\n    ],\n\n    errors: [\n      () => [selectors.allErrors, selectors.showErrors],\n      (errors, showErrors) => showErrors ? errors : {},\n      PropTypes.object\n    ]\n  }),\n\n  takeLatest: ({ actions, workers }) => ({\n    [actions.submit]: function * () {\n      const { submitSuccess, submitFailure } = this.actions\n\n      const hasErrors = yield this.get('hasErrors')\n\n      if (hasErrors) {\n        yield put(submitFailure())\n        return\n      }\n\n      // get the form data...\n      const values = yield this.get('values')\n      console.log('Submitting form with values:', values)\n\n      // simulate a 1sec async request.\n      yield delay(1000)\n\n      if (values) {\n        window.alert('Success')\n        yield put(submitSuccess())\n      } else {\n        window.alert('Error')\n        yield put(submitFailure())\n      }\n    }\n  })\n})\nexport default class SimpleForm extends Component {\n  render () {\n    const { isSubmitting, errors, values } = this.props\n    const { submit, setValue } = this.actions\n\n    const { name, email, message } = values\n\n    return (\n      <div>\n        <div className='form-field'>\n          <label>Name</label>\n          <input type='text' value={name} onChange={e => setValue('name', e.target.value)} />\n          {errors.name ? <div className='form-error'>{errors.name}</div> : null}\n        </div>\n\n        <div className='form-field'>\n          <label>E-mail</label>\n          <input type='text' value={email} onChange={e => setValue('email', e.target.value)} />\n          {errors.email ? <div className='form-error'>{errors.email}</div> : null}\n        </div>\n\n        <div className='form-field'>\n          <label className='block'>Message</label>\n          <textarea value={message} onChange={e => setValue('message', e.target.value)} />\n          {errors.message ? <div className='form-error'>{errors.message}</div> : null}\n        </div>\n\n        <button disabled={isSubmitting} onClick={submit}>\n          {isSubmitting ? 'Submitting...' : 'Submit!'}\n        </button>\n      </div>\n    )\n  }\n}\n"},692:function(e,t){e.exports="// create-form.js\n\nimport PropTypes from 'prop-types'\nimport { kea } from 'kea'\n\nexport default function createForm (options) {\n  // parse and clean up `options`\n\n  return kea({\n    // actions, reducers, etc that are built from `options`\n  })\n}\n"},693:function(e,t){e.exports="// form.js\n\nimport PropTypes from 'prop-types'\nimport { delay } from 'redux-saga'\n\nimport createForm from './create-form'\n\nconst isEmailValid = (email) => /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(email)\nconst missingText = 'This field is required'\n\nexport default createForm({\n  propTypes: {\n    name: PropTypes.string,\n    email: PropTypes.string,\n    message: PropTypes.string\n  },\n\n  defaults: {\n    name: 'John Doe',\n    email: '',\n    message: ''\n  },\n\n  validate: (values) => ({\n    name: !values.name ? missingText : null,\n    email: !values.email ? missingText : (!isEmailValid(values.email) ? 'Invalid e-mail' : null),\n    message: !values.message ? missingText : null\n  }),\n\n  submit: function * () {\n    // simulate a 1sec submission\n    yield delay(1000)\n\n    // either return the response:\n    // -> return { results: [] }\n\n    // or throw an exception:\n    // -> throw 'Everything is broken!'\n  },\n\n  success: function * (response) {\n    window.alert('submit successful!', response)\n  },\n\n  failure: function * (error) {\n    window.alert('submit error!', error.message)\n  }\n})\n"},694:function(e,t){e.exports="// create-form.js\n\nimport PropTypes from 'prop-types'\nimport { kea } from 'kea'\nimport { put, call } from 'redux-saga/effects'\n\nconst noop = () => ({})\n\nexport default function createForm (options) {\n  const propType = options.propTypes ? PropTypes.shape(options.propTypes) : PropTypes.object\n  const defaults = options.defaults || {}\n  const validate = options.validate || noop\n\n  const submit = options.submit || noop\n  const success = options.success || noop\n  const failure = options.failure || noop\n\n  return kea({\n    actions: () => ({\n      setValue: (key, value) => ({ key, value }),\n      setValues: (values) => ({ values }),\n\n      submit: true,\n      submitSuccess: (response) => ({ response }),\n      submitFailure: (error) => ({ error })\n    }),\n\n    reducers: ({ actions }) => ({\n      values: [defaults, propType, {\n        [actions.setValue]: (state, payload) => {\n          return Object.assign({}, state, { [payload.key]: payload.value })\n        },\n        [actions.setValues]: (state, payload) => {\n          return Object.assign({}, state, payload.values)\n        },\n        [actions.submitSuccess]: () => defaults\n      }],\n\n      isSubmitting: [false, PropTypes.bool, {\n        [actions.submit]: () => true,\n        [actions.submitSuccess]: () => false,\n        [actions.submitFailure]: () => false\n      }],\n\n      showErrors: [false, PropTypes.bool, {\n        [actions.submit]: () => true,\n        [actions.submitSuccess]: () => false\n      }]\n    }),\n\n    selectors: ({ selectors }) => ({\n      allErrors: [\n        () => [selectors.values],\n        validate,\n        PropTypes.object\n      ],\n\n      hasErrors: [\n        () => [selectors.allErrors],\n        (allErrors) => Object.values(allErrors).filter(k => k).length > 0,\n        PropTypes.bool\n      ],\n\n      errors: [\n        () => [selectors.allErrors, selectors.showErrors],\n        (errors, showErrors) => showErrors ? errors : {},\n        PropTypes.object\n      ]\n    }),\n\n    takeLatest: ({ actions, workers }) => ({\n      [actions.submit]: function * () {\n        const { submitSuccess, submitFailure } = this.actions\n\n        const hasErrors = yield this.get('hasErrors')\n\n        if (hasErrors) {\n          yield put(submitFailure())\n          return\n        }\n\n        try {\n          const response = yield call(submit.bind(this))\n          yield call(success.bind(this), response)\n          yield put(submitSuccess(response))\n        } catch (error) {\n          yield call(failure.bind(this), error)\n          yield put(submitFailure(error))\n        }\n      }\n    })\n  })\n}\n"},695:function(e,t){e.exports="// index.js\n\nimport React, { Component } from 'react'\nimport { connect } from 'kea'\n\nimport form from './form'\n\n@connect({\n  actions: [\n    form, [\n      'setValue',\n      'submit'\n    ]\n  ],\n  props: [\n    form, [\n      'values',\n      'isSubmitting',\n      'errors'\n    ]\n  ]\n})\nexport default class CreatedForm extends Component {\n  render () {\n    const { isSubmitting, errors, values } = this.props\n    const { submit, setValue } = this.actions\n\n    const { name, email, message } = values\n\n    return (\n      <div>\n        <div className='form-field'>\n          <label>Name</label>\n          <input type='text' value={name} onChange={e => setValue('name', e.target.value)} />\n          {errors.name ? <div className='form-error'>{errors.name}</div> : null}\n        </div>\n\n        <div className='form-field'>\n          <label>E-mail</label>\n          <input type='text' value={email} onChange={e => setValue('email', e.target.value)} />\n          {errors.email ? <div className='form-error'>{errors.email}</div> : null}\n        </div>\n\n        <div className='form-field'>\n          <label className='block'>Message</label>\n          <textarea value={message} onChange={e => setValue('message', e.target.value)} />\n          {errors.message ? <div className='form-error'>{errors.message}</div> : null}\n        </div>\n\n        <button disabled={isSubmitting} onClick={submit}>\n          {isSubmitting ? 'Submitting...' : 'Submit!'}\n        </button>\n      </div>\n    )\n  }\n}\n"}});